<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>PyMARC en Español - Búsqueda con PyMARC</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05_introduccion_pymarc3.html" rel="next">
<link href="./03_introduccion_pymarc.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="css/output.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">PyMARC en Español</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-taller-introductorio-pymarc" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Taller Introductorio PyMARC</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-taller-introductorio-pymarc">    
        <li>
    <a class="dropdown-item" href="./01_introduccion.html">
 <span class="dropdown-text">Introducción y Configuración</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./02_introduccion_python.html">
 <span class="dropdown-text">Python 101</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./03_introduccion_pymarc.html">
 <span class="dropdown-text">Introducción a PyMarc</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./04_introduccion_pymarc2.html">
 <span class="dropdown-text">Búsqueda con PyMARC</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./05_introduccion_pymarc3.html">
 <span class="dropdown-text">Editar con PyMARC</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./06_introduccion_pymarc4.html">
 <span class="dropdown-text">Guardar archivos MARC</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#busqueda-general" id="toc-busqueda-general" class="nav-link active" data-scroll-target="#busqueda-general">Busqueda General</a></li>
  <li><a href="#búsqueda-de-campos-específicos-con-pymarc" id="toc-búsqueda-de-campos-específicos-con-pymarc" class="nav-link" data-scroll-target="#búsqueda-de-campos-específicos-con-pymarc">Búsqueda de campos específicos con PyMARC</a></li>
  <li><a href="#subcampos-y-bucles-anidados" id="toc-subcampos-y-bucles-anidados" class="nav-link" data-scroll-target="#subcampos-y-bucles-anidados">Subcampos y bucles anidados</a></li>
  <li><a href="#métodos-especiales-de-pymarc" id="toc-métodos-especiales-de-pymarc" class="nav-link" data-scroll-target="#métodos-especiales-de-pymarc">Métodos especiales de PyMARC</a>
  <ul class="collapse">
  <li><a href="#get_fields-get_subfields" id="toc-get_fields-get_subfields" class="nav-link" data-scroll-target="#get_fields-get_subfields"><code>get_fields()</code>, <code>get_subfields()</code></a></li>
  <li><a href="#acceder-a-indicadores-de-un-campo-.indicator1-.indicator2" id="toc-acceder-a-indicadores-de-un-campo-.indicator1-.indicator2" class="nav-link" data-scroll-target="#acceder-a-indicadores-de-un-campo-.indicator1-.indicator2">Acceder a indicadores de un campo, .indicator1 , .indicator2</a></li>
  </ul></li>
  <li><a href="#otros-métodos-del-objeto-record" id="toc-otros-métodos-del-objeto-record" class="nav-link" data-scroll-target="#otros-métodos-del-objeto-record">Otros métodos del objeto <code>record</code></a></li>
  <li><a href="#construyendo-un-parser-básico" id="toc-construyendo-un-parser-básico" class="nav-link" data-scroll-target="#construyendo-un-parser-básico">Construyendo un parser básico</a></li>
  <li><a href="#otros-ejemplos" id="toc-otros-ejemplos" class="nav-link" data-scroll-target="#otros-ejemplos">Otros ejemplos</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Búsqueda con PyMARC</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<ul>
<li><p>Sample Data: <a href="data/edited_69x_subject.mrc">edited_69x_subject.mrc</a></p></li>
<li><p>Enlace al google colab (python Basics, PyMarc Basics)</p></li>
</ul>
<p>Vamos a seguir explorando cómo realizar búsquedas.</p>
<section id="busqueda-general" class="level2">
<h2 class="anchored" data-anchor-id="busqueda-general">Busqueda General</h2>
<p><strong>¿Qué pasa si queremos encontrar cualquier registro que contenga un termino en particular?</strong></p>
<p>Sugerencias: * California * San Francisco * lesbian</p>
<div id="6bc35f3b" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importamos la biblioteca pymarc, que nos ayuda a leer archivos MARC</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pymarc</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>termino_de_busqueda <span class="op">=</span> <span class="st">"California"</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos el nombre del archivo MARC que vamos a leer</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>my_marc_file <span class="op">=</span> <span class="st">"data/edited_69x_subject.mrc"</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Abrimos el archivo en modo binario ('rb' significa 'read binary')</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(my_marc_file, <span class="st">'rb'</span>) <span class="im">as</span> data:</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Creamos un lector de registros MARC a partir del archivo abierto</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    reader <span class="op">=</span> pymarc.MARCReader(data)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recorremos cada registro en el archivo MARC</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> record <span class="kw">in</span> reader:</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> termino_de_busqueda <span class="kw">in</span> <span class="bu">str</span>(record):</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(record)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Detener después del primer registro con "New Zealand"</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=LDR  08224cpcaa22009377a 4500
=001  13109011
=005  20221206230121.0
=006  knnn\\\\\\\\\\\\kn
=006  innn\\\\\\\\\\\\\\
=006  m\\\\\\\\d\\\\\\\\
=006  rnnn\\\\\\\\\\\\rn
=008  170406i19632005ctu\\\\\\\\\\\\\\\\\eng\d
=035  \\$9(YUL)ead.beinecke.oleary
=035  \\$a13109011
=040  \\$aCtY-BR$beng$cCtY-BR$edacs
=043  \\$an-us---$an-us-ca
=100  1\$aO'Leary, Jean.
=245  10$aJean O'Leary papers,$f1963-2005.
=300  \\$a18.35$flinear feet (20 boxes)
=351  \\$aOrganized into five series: I. Professional Papers, 1973-2005. II. Correspondence, 1976-2004. III. Personal Papers, 1963-2005. IV. Photographs, circa 1970-2005. V. Computer and Audiovisual Media, circa 1990-1994.
=506  0\$aThis material is open for research.
=506  1\$3Box 19 (computer media): Restricted Fragile Material. Reference copies of electronic files may be requested. Consult Access Services for further information.
=506  1\$3Box 20 (audiovisual material): Restricted fragile material. Reference copies may be requested. Consult Access Services for further information.
=545  \\$aJean O'Leary was a former Roman Catholic nun who left her convent in 1971 to join the gay rights movement in New York City. O'Leary was a member of the Gay Activists Alliance until 1972 when she broke away from the group and formed Lesbian Feminist Liberation. She was co-executive director of the National Gay and Lesbian Task Force from 1976 to 1979 and subsequently became executive director of National Gay Rights Advocates. In 1977 O'Leary and Midge Costanza, her then-partner and special assistant to President Jimmy Carter, organized the first meeting of gay rights activists at the White House. O'Leary was also a speaker at the 1977 National Women's Conference. In 1988, she co-founded National Coming Out Day. O'Leary was active in Democratic Party politics and chaired the Democratic National Committee's Gay and Lesbian Caucus from 1992 to 2002; her marketing company, O'Leary &amp; Associates, worked on political campaigns in California for Barbara Boxer, Ron Brown, and Dianne Feinstein. She and her partner, Lisa Phelps, had a daughter, Victoria, and a son David de Maria.
=520  \\$aThe collection consists of professional papers, correspondence, personal papers, photographs, and computer and audiovisual media by or relating to gay rights activist and former Catholic nun Jean O'Leary. Professional papers document her work as executive director of National Gay Rights Advocates, including a lawsuit against the National Institutes of Health and Food and Drug Administration over approval times for AIDS drugs. Also present are materials related to the National Gay and Lesbian Task Force, National Coming Out Day, Gay Activists Alliance, Access Now for Gay and Lesbian Equality, and the Democratic National Committee, and O'Leary's writings and speeches concerning advocacy and legal rights of gays and lesbians. Among the correspondents are Barbara Boxer, Ron Brown, Bill Clinton, Midge Costanza, Michael Dukakis, Dianne Feinstein, Ed Koch, Kate Millett, David B. Mixner, Sean Strub, Bruce Voeller, Sarah Weddington, Kay Whitlock, and Molly Yard. Personal papers contain awards, school papers, yearbooks, clippings, and interviews, in addition to pinback buttons, t-shirts, and other memorabilia commemorating gay rights milestones and political campaigns. Photographs feature O’Leary, Bella Abzug, Virginia Apuzzo, Tammy Baldwin, Costanza, Martin Duberman, Florynce Kennedy, Gloria Steinem, and Voeller, and events such as the Lesbian Feminist Liberation "Lavender Dinosaur Demonstration" in New York, Equal Rights Amendment march on Washington D.C., and the Democratic National Convention. Computer and audiovisual media chiefly relate to political campaigns.
=555  \\$aFinding aid available.
=561  \\$aPurchased from Glenn Horowitz Bookseller, Inc., on the Edwin J. Beinecke Book Fund Fund, 2017.
=546  \\$aIn English.
=524  \\$aJean O'Leary Papers. General Collection, Beinecke Rare Book and Manuscript Library, Yale University.
=600  10$aApuzzo, Virginia,$d1941-
=600  10$aBaldwin, Tammy,$d1962-$0http://id.loc.gov/authorities/names/no2012147673
=600  10$aBoxer, Barbara.$0http://id.loc.gov/authorities/names/n93084010
=600  10$aBrown, Ronald Harmon,$d1941-2006.$0http://id.loc.gov/authorities/names/no93026751
=600  10$aClinton, Bill,$d1946-$0http://id.loc.gov/authorities/names/n82029644
=600  10$aCostanza, Midge,$d1932-2010.$0http://id.loc.gov/authorities/names/n2015063966
=600  10$aDuberman, Martin B.,$d1930-$0http://id.loc.gov/authorities/names/n50023840
=600  10$aDukakis, Michael S.$q(Michael Stanley),$d1933-$0http://id.loc.gov/authorities/names/n80011660
=600  10$aFeinstein, Dianne,$d1933-$0http://id.loc.gov/authorities/names/n91064892
=600  10$aKennedy, Florynce,$d1916-2000.$0http://id.loc.gov/authorities/names/n82039729
=600  10$aKoch, Ed,$d1924-2013.$0http://id.loc.gov/authorities/names/n81051888
=600  10$aMillett, Kate.$0http://id.loc.gov/authorities/names/n79018615
=600  10$aMixner, David B.$0http://id.loc.gov/authorities/names/n91019032
=600  10$aO'Leary, Jean.
=600  10$aSteinem, Gloria.$0http://id.loc.gov/authorities/names/n83074143
=600  10$aStrub, Sean O'Brien.$0http://id.loc.gov/authorities/names/n85377205
=600  10$aVoeller, Bruce R.$0http://id.loc.gov/authorities/names/n88037673
=600  10$aWeddington, Sarah Ragle.$0http://id.loc.gov/authorities/names/n87151192
=600  10$aWhitlock, Kay.$0http://id.loc.gov/authorities/names/no2005085173
=600  10$aYard, Molly,$d1912-2005.$0http://id.loc.gov/authorities/names/no2016120397
=610  20$aAccess Now for Gay and Lesbian Equality.
=610  20$aComing Out Project (Human Rights Campaign)$0http://id.loc.gov/authorities/names/no2009013771
=610  20$aDemocratic National Committee (U.S.)$0http://id.loc.gov/authorities/names/n81133513
=610  20$aDemocratic Party (U.S.)$0http://id.loc.gov/authorities/names/n79054058
=610  20$aGay Activists Alliance.$0http://id.loc.gov/authorities/names/n93060721
=610  20$aLesbian Feminist Liberation.$0http://id.loc.gov/authorities/names/nr93017195
=610  20$aNational Gay and Lesbian Task Force (U.S.)$0http://id.loc.gov/authorities/names/n85274932
=610  20$aNational Gay Rights Advocates (U.S.)$0http://id.loc.gov/authorities/names/n88121201
=650  \0$aAIDS activists$zUnited States.
=650  \0$aEqual rights amendments.$0http://id.loc.gov/authorities/subjects/sh85044501
=650  \0$aGay liberation movement$zUnited States.$0http://id.loc.gov/authorities/subjects/sh93005114
=650  \0$aGay rights$zUnited States.$0http://id.loc.gov/authorities/subjects/sh2008105072
=650  \0$aLesbian activists$zUnited States.
=650  \0$aLesbian feminism.$0http://id.loc.gov/authorities/subjects/sh93000705
=650  \0$aLesbian nuns.$0http://id.loc.gov/authorities/subjects/sh85076156
=650  \0$aLesbians$xLegal status, laws, etc.$zUnited States.
=650  \0$aLesbians' writings.$0http://id.loc.gov/authorities/subjects/sh86002214
=650  \0$aPolitical activists$zUnited States.$0http://id.loc.gov/authorities/subjects/sh98001482
=650  \0$aPolitical campaigns$zUnited States.$0http://id.loc.gov/authorities/subjects/sh2008109540
=650  \0$aPolitical parties$zCalifornia.
=650  \0$aProtest movements$zUnited States$y20th century.
=650  \0$aSexual minorities.$0http://id.loc.gov/authorities/subjects/sh2004003385
=650  \0$aWomen$xPolitical activity.$0http://id.loc.gov/authorities/subjects/sh85147597
=655  \7$aAudiovisual materials.$2aat
=655  \7$aBorn digital.$2aat
=655  \7$aButtons (information artifacts)$2aat
=655  \7$aPhotographs.$2aat
=655  \7$aSweat shirts.$2aat
=655  \7$aT-shirts.$2aat
=852  \\$aBeinecke Rare Book and Manuscript Library, Yale University, New Haven, CT
=856  42$3View a description and listing of collection contents in the finding aid$uhttp://hdl.handle.net/10079/fa/beinecke.oleary
=690  04$aLGBTQ resource.
</code></pre>
</div>
</div>
</section>
<section id="búsqueda-de-campos-específicos-con-pymarc" class="level2">
<h2 class="anchored" data-anchor-id="búsqueda-de-campos-específicos-con-pymarc">Búsqueda de campos específicos con PyMARC</h2>
<p>La busqueda anterior imprime todos los campos the un registro.Esto podría devolver una gran cantidad de datos de poco interes para nosotors. Pensemos en cómo podríamos formular mejor esta pregunta para refinar los resultados.</p>
<p>Si en lugar de imprimir todo el registro, queremos ver sólo los campos MARC que contienen el patrón de interes, podemos añadir otro bucle.</p>
<p>Además, podríamos querer mostrar el identificador del registro junto con el campo coincidente:</p>
<div id="b7c547e0" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importamos la biblioteca pymarc, que nos ayuda a leer archivos MARC</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pymarc</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>termino_de_busqueda <span class="op">=</span> <span class="st">"California"</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos el nombre del archivo MARC que vamos a leer</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>my_marc_file <span class="op">=</span> <span class="st">"data/edited_69x_subject.mrc"</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Abrimos el archivo en modo binario ('rb' significa 'read binary')</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(my_marc_file, <span class="st">'rb'</span>) <span class="im">as</span> data:</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Creamos un lector de registros MARC a partir del archivo abierto</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    reader <span class="op">=</span> pymarc.MARCReader(data)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recorremos cada registro en el archivo MARC</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> record <span class="kw">in</span> reader:</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> termino_de_busqueda <span class="kw">in</span> <span class="bu">str</span>(record):</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Iterar por cada campo del registro</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> field <span class="kw">in</span> record:</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> termino_de_busqueda <span class="kw">in</span> field.value():</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Si encontramos el patron devolvemos el BIB_ID y el campo</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(record[<span class="st">'001'</span>].value(), field)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>13109011 =545  \\$aJean O'Leary was a former Roman Catholic nun who left her convent in 1971 to join the gay rights movement in New York City. O'Leary was a member of the Gay Activists Alliance until 1972 when she broke away from the group and formed Lesbian Feminist Liberation. She was co-executive director of the National Gay and Lesbian Task Force from 1976 to 1979 and subsequently became executive director of National Gay Rights Advocates. In 1977 O'Leary and Midge Costanza, her then-partner and special assistant to President Jimmy Carter, organized the first meeting of gay rights activists at the White House. O'Leary was also a speaker at the 1977 National Women's Conference. In 1988, she co-founded National Coming Out Day. O'Leary was active in Democratic Party politics and chaired the Democratic National Committee's Gay and Lesbian Caucus from 1992 to 2002; her marketing company, O'Leary &amp; Associates, worked on political campaigns in California for Barbara Boxer, Ron Brown, and Dianne Feinstein. She and her partner, Lisa Phelps, had a daughter, Victoria, and a son David de Maria.
13109011 =650  \0$aPolitical parties$zCalifornia.
16265055 =545  \\$aEileen Myles is an American writer, educator, and performance artist who has published over twenty books of poetry, fiction, and nonfiction, including the autobiographical novel Chelsea Girls (1994). They were born on December 9, 1949 in Cambridge, Massachusetts, and graduated from the University of Massachusetts at Boston in 1971 with a B.A. in English. After moving to New York City in 1974, they studied in workshops at St. Mark’s Poetry Project with Ted Berrigan, Alice Notley, and Paul Violi. They later served as the organization’s artistic director from 1984 to 1986. Myles is the author of books of poetry such as I Must Be Living Twice: New and Selected Poems 1974-2014 (2015) and Evolution (2018), the novel Cool for You (2000), and Afterglow (a dog memoir) (2017). Their poetry, essays, and articles have been featured in numerous anthologies and publications such as Harper’s Magazine, The New Yorker, and The Village Voice. They additionally have appeared in film and television, and created performance pieces including The Collection of Silence for the Dia Center for the Arts in New York in 2010. Myles has taught writing and literature at Columbia University, New York University, University of California, San Diego, Bard College, and other institutions. Their awards include the American Academy of Arts and Letters Award, the Poetry Society of America Shelly Award, and four Lambda Book Awards. Myles has also received fellowships and grants from the Guggenheim Foundation, the National Endowment for the Arts, the MacDowell Colony, and Creative Capital. Myles lives in New York City and Marfa, Texas. They use they/them pronouns.
16764331 =650  \0$aSmall presses$zCalifornia.
17213320 =545  \\$aDorothy Gray (born October 23, 1922), actress, talent manager, and assistant to Katherine Dunham, grew up in Los Angeles, CA. The niece of Charlie Chaplin, Gray became a child actress at a very young age, appearing in films as early as 1924. She was later cast in a number of Hollywood productions, including uncredited roles in Symphony of Six Million (1932), Men in White (1934), and Rose-Marie (1936). In the 1940s she started working with jazz musicians and stage performers in Hollywood as an assistant and manager. When Gray was nineteen, she met Katherine Dunham at the Paramount Theater in Los Angeles. The two formed a close bond that was “romantic, sisterly, and maternal” (Das 2017). Dorothy Gray managed Katherine Dunham’s business and bookings in the United States until her death in 1976. From the 1950s onward Gray was in two long term romantic relationships with two women, Ann Hathaway and Kellie Greene. Dorothy Gray died May 9, 1976, in Los Angeles, California.
17213320 =520  \\$aThe Dorothy Gray papers span the years 1890-1994 and consist of correspondence, photographic prints and negatives, photograph albums, musical scores, clippings, appointment books, and files related to her life in Hollywood and her career as a talent manager, including scrapbooks following the careers of friends and associates. The collection also documents her family and childhood. A bulk of the collection material relates to her relationships with her social circle in California during the years 1951-1968. Included are love letters Gray exchanged with pianist Kellie Greene and jazz singer Ann Hathaway as well as photographs of their travels, family, and pets.
9742319 =650  \0$aTheater programs$zCalifornia$zSan Francisco.
9742319 =651  \7$aCalifornia$zSan Francisco.$2fast$0(OCoLC)fst01204481
9742319 =655  \7$aTheater programs$zCalifornia$zSan Francisco.$2rbgenr
9742360 =650  \0$aGay theater$zCalifornia$zSan Francisco.
9742360 =650  \0$aTheater$zCalifornia$zSan Francisco.
9742360 =650  \0$aPerforming arts$xTicket subscription$zCalifornia$zSan Francisco.
13628698 =752  \\$aUnited States$bCalifornia$dSan Francisco.
14059505 =752  \\$aUnited States$bCalifornia$dRohnert Park.
16687567 =752  \\$aUnited States$bCalifornia$dLos Angeles.
16786288 =264  \0$a[California?],$c[2009-2010?]
16786288 =650  \0$aBisexuals$zCalifornia$zSan Francisco$vPictorial works.
16786288 =650  \0$aGay men$zCalifornia$zSan Francisco$vPictorial works.
16786288 =650  \0$aIntersex people$zCalifornia$zSan Francisco$vPictorial works.
16786288 =650  \0$aLesbians$zCalifornia$zSan Francisco$vPictorial works.
16786288 =650  \0$aTransgender people$zCalifornia$zSan Francisco$vPictorial works.
16786288 =752  \\$aUnited States$bCalifornia.</code></pre>
</div>
</div>
<hr>
</section>
<section id="subcampos-y-bucles-anidados" class="level2">
<h2 class="anchored" data-anchor-id="subcampos-y-bucles-anidados">Subcampos y bucles anidados</h2>
<p>Podemos aplicar el mismo enfoque con bucles para acceder a los <strong>subcampos</strong> de cualquier campo que los tenga:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> reader:</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> field <span class="kw">in</span> record:</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(field)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> subfield <span class="kw">in</span> field:</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(subfield)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="métodos-especiales-de-pymarc" class="level2">
<h2 class="anchored" data-anchor-id="métodos-especiales-de-pymarc">Métodos especiales de PyMARC</h2>
<p>PyMARC ofrece varios <strong>métodos abreviados</strong> para acceder a campos y subcampos de forma elegante.</p>
<section id="get_fields-get_subfields" class="level3">
<h3 class="anchored" data-anchor-id="get_fields-get_subfields"><code>get_fields()</code>, <code>get_subfields()</code></h3>
<div id="93a54d5b" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pymarc</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>my_marc_file <span class="op">=</span> <span class="st">"data/edited_69x_subject.mrc"</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(my_marc_file, <span class="st">'rb'</span>) <span class="im">as</span> data:</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    reader <span class="op">=</span> pymarc.MARCReader(data)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> record <span class="kw">in</span> reader:</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"California"</span> <span class="kw">in</span> <span class="bu">str</span>(record):</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(record.leader)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>            my_245s <span class="op">=</span> record.get_fields(<span class="st">'245'</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> my_245 <span class="kw">in</span> my_245s:</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>                subfields <span class="op">=</span> my_245.get_subfields(<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'f'</span>, <span class="st">'g'</span>, <span class="st">'h'</span>, <span class="st">'k'</span>, <span class="st">'n'</span>, <span class="st">'p'</span>, <span class="st">'s'</span>, <span class="st">'6'</span>, <span class="st">'8'</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> sub <span class="kw">in</span> subfields:</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">"  "</span>,sub)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Detener después del primer campo 245 del registro</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>08224cpcaa22009377a 4500
   Jean O'Leary papers,
   1963-2005.
09802cpcaa2201129 i 4500
   Eileen Myles papers,
   1958-2017.
07228cpcaa2200733 i 4500
   Paul Mariah papers,
   1898-2014
   (bulk 1960-1988).
03252cpcaa2200361 i 4500
   Dorothy Gray papers,
   1890-1994
01861cam a2200337Mi 4500
   "George Washington slept here" /
   by George S. Kaufman &amp; Moss Hart ; directed by Donald McLean ; produced by Perry George &amp; Rod Schaefer.
01069cam a2200277Mi 4500
   Theatre Rhinoceros presents the 1984-85 season of High drama :
   our 8th season.
01967cam a2200457 a 4500
   Mama's boy /
   Bev Arthur and Martin Arthur.
02024cam a2200421 a 4500
   Witness :
   the artist's vision in The face of AIDS /
   Jackie Kirk, Barbara Swift Brauer.
03049cam a2200529 i 4500
   The men with the pink triangle :
   the true, life-and-death story of homosexuals in the Nazi death camps /
   by Heinz Heger ; translated by David Fernbach.
02208cam a2200337 i 4500
   Snap/shot :
   99 years of looking fabulous.</code></pre>
</div>
</div>
<p>Para obtener esta lista de subcampos consultamos:<br>
https://www.loc.gov/marc/bibliographic/concise/bd245.html</p>
</section>
<section id="acceder-a-indicadores-de-un-campo-.indicator1-.indicator2" class="level3">
<h3 class="anchored" data-anchor-id="acceder-a-indicadores-de-un-campo-.indicator1-.indicator2">Acceder a indicadores de un campo, .indicator1 , .indicator2</h3>
<div id="27f7e1dc" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pymarc</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>my_marc_file <span class="op">=</span> <span class="st">"data/edited_69x_subject.mrc"</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Imprimir mas de un registro</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>count<span class="op">=</span><span class="dv">0</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="bu">max</span> <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(my_marc_file, <span class="st">'rb'</span>) <span class="im">as</span> data:</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    reader <span class="op">=</span> pymarc.MARCReader(data)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> record <span class="kw">in</span> reader:</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(record[<span class="st">'245'</span>])</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Indicador 1 del campo 245:"</span>, record[<span class="st">'245'</span>].indicator1)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Indicador 2 del campo 245:"</span>, record[<span class="st">'245'</span>].indicator2)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>        count<span class="op">+=</span><span class="dv">1</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Romper el ciclo al llegar al maximo</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;=</span> <span class="bu">max</span>:</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=245  10$aFamily Equality Council records,$f1977-2014 (inclusive).
Indicador 1 del campo 245: 1
Indicador 2 del campo 245: 0
=245  10$aRainbow Families records,$f1983-2011 (inclusive).
Indicador 1 del campo 245: 1
Indicador 2 del campo 245: 0
=245  10$aJean O'Leary papers,$f1963-2005.
Indicador 1 del campo 245: 1
Indicador 2 del campo 245: 0
=245  10$aFreedom to Marry records,$f1948-2016 (inclusive).
Indicador 1 del campo 245: 1
Indicador 2 del campo 245: 0
=245  10$aMichael Antisdale and Mark R. Melanson Papers,$f1995-2003 (inclusive).
Indicador 1 del campo 245: 1
Indicador 2 del campo 245: 0</code></pre>
</div>
</div>
<p>Podemos usar los indicadores como filtro:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> reader:</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> record[<span class="st">'245'</span>].indicator2 <span class="op">!=</span> <span class="st">'0'</span>:</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(record[<span class="st">'245'</span>])</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
</section>
<section id="otros-métodos-del-objeto-record" class="level2">
<h2 class="anchored" data-anchor-id="otros-métodos-del-objeto-record">Otros métodos del objeto <code>record</code></h2>
<p>PyMARC ofrece accesos directos a datos comunes:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>record.author()</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>record.isbn()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>record.issn()</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>record.issn_title()</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>record.leader</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>record.location()</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>record.pos</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>record.publisher()</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>record.pubyear()</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>record.series()</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>record.sudoc()</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>record.title()</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>record.uniformtitle()</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>record.notes()</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>record.subjects()</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>record.physicaldescription()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Puedes probar:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> reader:</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(record)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(record.author())</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(record.isbn())</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(record.issn())</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    quit()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="construyendo-un-parser-básico" class="level2">
<h2 class="anchored" data-anchor-id="construyendo-un-parser-básico">Construyendo un parser básico</h2>
<div id="df5440d3" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pymarc <span class="im">import</span> MARCReader</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>archivo <span class="op">=</span> <span class="st">"data/edited_69x_subject.mrc"</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Abrimos el archivo MARC</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(archivo, <span class="st">"rb"</span>) <span class="im">as</span> data:</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    reader <span class="op">=</span> MARCReader(data)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Iteramos sobre los registros</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> record <span class="kw">in</span> reader:</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Mostramos el ID del registro (campo 001)</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> record[<span class="st">'001'</span>]:</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"ID:"</span>, record[<span class="st">'001'</span>].value())</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"ID: (no disponible)"</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Recorremos todos los campos del registro</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> my_field <span class="kw">in</span> record:</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Intentamos acceder a los indicadores (solo existen en campos con subcampos)</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>                ind_1 <span class="op">=</span> my_field.indicator1 <span class="kw">or</span> <span class="st">"/"</span>  <span class="co"># "/" si el indicador no está definido</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>                ind_2 <span class="op">=</span> my_field.indicator2 <span class="kw">or</span> <span class="st">"/"</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\t</span><span class="ss">Tag #: </span><span class="sc">{</span>my_field<span class="sc">.</span>tag<span class="sc">}</span><span class="ss">  Indicador 1: </span><span class="sc">{</span>ind_1<span class="sc">}</span><span class="ss">  Indicador 2: </span><span class="sc">{</span>ind_2<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">AttributeError</span>:</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Si el campo no tiene indicadores (como los de control), solo mostramos el tag</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\t</span><span class="ss">Tag #: </span><span class="sc">{</span>my_field<span class="sc">.</span>tag<span class="sc">}</span><span class="ss"> (no posee indicadores)"</span>)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Recorremos los subcampos (si existen)</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">hasattr</span>(my_field, <span class="st">'__iter__'</span>):</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> key, value <span class="kw">in</span> my_field:</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\t\t</span><span class="ss">Subcampo $</span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"-"</span> <span class="op">*</span> <span class="dv">50</span> <span class="op">+</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Solo mostramos un registro como ejemplo</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ID: 12251425
    Tag #: 001 (no posee indicadores)
    Tag #: 005 (no posee indicadores)
    Tag #: 008 (no posee indicadores)
    Tag #: 035  Indicador 1:    Indicador 2:  
        Subcampo $9: (YUL)ead.mssa.ms.2000
    Tag #: 035  Indicador 1:    Indicador 2:  
        Subcampo $a: 12251425
    Tag #: 040  Indicador 1:    Indicador 2:  
        Subcampo $a: CtY
        Subcampo $b: eng
        Subcampo $c: CtY
        Subcampo $e: dacs
    Tag #: 079  Indicador 1:    Indicador 2:  
        Subcampo $a: (OCoLC)1007214876
    Tag #: 090  Indicador 1:    Indicador 2:  
        Subcampo $a: MS 2000
    Tag #: 110  Indicador 1: 2  Indicador 2:  
        Subcampo $a: Family Equality Council.
        Subcampo $0: http://id.loc.gov/authorities/names/no2012037822
    Tag #: 245  Indicador 1: 1  Indicador 2: 0
        Subcampo $a: Family Equality Council records,
        Subcampo $f: 1977-2014 (inclusive).
    Tag #: 300  Indicador 1:    Indicador 2:  
        Subcampo $a: 11 linear feet. (23 boxes)
    Tag #: 351  Indicador 1:    Indicador 2:  
        Subcampo $a: The materials are arranged according to document type.
    Tag #: 506  Indicador 1:    Indicador 2:  
        Subcampo $a: The materials are open for research with the exception of the  electronic files, which are closed until processed.
    Tag #: 520  Indicador 1:    Indicador 2:  
        Subcampo $a: This collection consists of the records of Family Equality Council, a national advocacy organization for esbian, gay, bisexual, transgender, and queer (LGBTQ) parents, guardians, and allies. Materials in the collection consist of correspondence, annual and quarterly reports, articles and clippings, board of directors records, event records, financial and fundraising records, publications, subject files, and electronic files. The collection is particularly strong both for its documentation of the group's activism and advocacy efforts, as well as its efforts to provide community for and document the everyday lives and experiences of LGBTQ families.
    Tag #: 524  Indicador 1:    Indicador 2:  
        Subcampo $a: Family Equality Council Records (MS 2000).  Manuscripts and Archives, Yale University Library.
    Tag #: 540  Indicador 1:    Indicador 2:  
        Subcampo $a: Copyright is retained by the creator(s) of this collection for materials they have authored or otherwise produced. After the lifetime of the creator(s) or until January 1, 2039 (date), whichever comes first, copyright passes to Yale University whether such works are at Yale or physically located elsewhere in the world. Copyright status for other collection materials is unknown. Additional information is provided in the finding aid.
    Tag #: 544  Indicador 1:    Indicador 2:  
        Subcampo $a: Related material: Rainbow Families records (MS 2006).
    Tag #: 545  Indicador 1:    Indicador 2:  
        Subcampo $a: Family Equality Council is a national advocacy organization dedicated to securing equal rights for lesbian, gay, bisexual, transgender, and queer (LGBTQ) parents, guardians, and allies. Family Equality Council has its origins in the Gay Fathers Coalition, an organization founded in 1979. In 1986, the Gay Fathers Coalition expanded to include lesbian mothers, prompting the group to rename itself the Gay and Lesbian Parents Coalition International (GLPCI). In 1998, GLPCI changed its name to the Family Pride Coalition in order to include bisexual and transgender parents among its members and constituents. In that same year, a group of youth who had been involved with Family Pride Coalition established a separate advocacy organization for the children of LGBTQ parents, Children of Lesbians and Gays Everywhere (COLAGE). In 2007, the Family Pride Coalition merged with Rainbow Families, and in that same year renamed itself again as Family Equality Council. Later, the group dropped Council from its name, becoming Family Equality in 2018.
    Tag #: 546  Indicador 1:    Indicador 2:  
        Subcampo $a: The materials are in English.
    Tag #: 555  Indicador 1:    Indicador 2:  
        Subcampo $a: The finding aid is available in the repository and on the Internet.
    Tag #: 561  Indicador 1:    Indicador 2:  
        Subcampo $a: The materials were the gift of Family Equality Council, 2014.
    Tag #: 610  Indicador 1: 2  Indicador 2: 0
        Subcampo $a: COLAGE.
        Subcampo $0: http://id.loc.gov/authorities/names/no2008088417
    Tag #: 610  Indicador 1: 2  Indicador 2: 0
        Subcampo $a: Family Equality Council.
        Subcampo $0: http://id.loc.gov/authorities/names/no2012037822
    Tag #: 610  Indicador 1: 2  Indicador 2: 0
        Subcampo $a: Family Pride Coalition.
    Tag #: 610  Indicador 1: 2  Indicador 2: 0
        Subcampo $a: Gay and Lesbian Parents Coalition International.
        Subcampo $0: http://id.loc.gov/authorities/names/nr2002025214
    Tag #: 610  Indicador 1: 2  Indicador 2: 0
        Subcampo $a: Gay Fathers Coalition.
    Tag #: 610  Indicador 1: 2  Indicador 2: 0
        Subcampo $a: Rainbow Families.
    Tag #: 650  Indicador 1:    Indicador 2: 0
        Subcampo $a: Adoptive parents.
        Subcampo $0: http://id.loc.gov/authorities/subjects/sh92003241
    Tag #: 650  Indicador 1:    Indicador 2: 0
        Subcampo $a: Bisexuals
        Subcampo $z: United States.
        Subcampo $0: http://id.loc.gov/authorities/subjects/sh98006061
    Tag #: 650  Indicador 1:    Indicador 2: 0
        Subcampo $a: Families
        Subcampo $z: United States.
        Subcampo $0: http://id.loc.gov/authorities/subjects/sh85047032
    Tag #: 650  Indicador 1:    Indicador 2: 0
        Subcampo $a: Gay fathers.
        Subcampo $0: http://id.loc.gov/authorities/subjects/sh90000760
    Tag #: 650  Indicador 1:    Indicador 2: 0
        Subcampo $a: Gay men
        Subcampo $x: Legal status, laws, etc.
        Subcampo $z: United States.
    Tag #: 650  Indicador 1:    Indicador 2: 0
        Subcampo $a: Gay parents.
        Subcampo $0: http://id.loc.gov/authorities/subjects/sh85061779
    Tag #: 650  Indicador 1:    Indicador 2: 0
        Subcampo $a: Gay rights
        Subcampo $z: United States.
        Subcampo $0: http://id.loc.gov/authorities/subjects/sh2008105072
    Tag #: 650  Indicador 1:    Indicador 2: 0
        Subcampo $a: Lesbian mothers.
        Subcampo $0: http://id.loc.gov/authorities/subjects/sh85076155
    Tag #: 650  Indicador 1:    Indicador 2: 0
        Subcampo $a: Transgender people
        Subcampo $z: United States.
        Subcampo $0: http://id.loc.gov/authorities/subjects/sh2012000715
    Tag #: 650  Indicador 1:    Indicador 2: 0
        Subcampo $a: Transsexuals
        Subcampo $z: United States.
        Subcampo $0: http://id.loc.gov/authorities/subjects/sh2003008858
    Tag #: 852  Indicador 1:    Indicador 2:  
        Subcampo $a: Manuscripts and Archives,
        Subcampo $b: Yale University Library,
        Subcampo $e: P.O. Box 208240, New Haven, CT  06520-8240.
    Tag #: 856  Indicador 1: 4  Indicador 2: 2
        Subcampo $3: View a description and listing of collection contents in the finding aid
        Subcampo $u: http://hdl.handle.net/10079/fa/mssa.ms.2000
    Tag #: 690  Indicador 1: 0  Indicador 2: 4
        Subcampo $a: LGBTQ resource.

--------------------------------------------------
</code></pre>
</div>
</div>
<p><strong>¿Qué hace este código?</strong></p>
<p>Esta tabla resume el propósito de cada parte del código:</p>
<table class="table">
<colgroup>
<col style="width: 36%">
<col style="width: 63%">
</colgroup>
<thead>
<tr class="header">
<th>Parte del código</th>
<th>¿Qué hace?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>record['001'].value()</code></td>
<td>Muestra el ID del registro (<code>campo 001</code>)</td>
</tr>
<tr class="even">
<td><code>for my_field in record:</code></td>
<td>Recorre todos los campos del registro</td>
</tr>
<tr class="odd">
<td><code>my_field.tag</code></td>
<td>Muestra el número de campo (por ejemplo, 245, 100, etc.)</td>
</tr>
<tr class="even">
<td><code>my_field.indicator1 / indicator2</code></td>
<td>Muestra los indicadores (si existen)</td>
</tr>
<tr class="odd">
<td><code>for key, value in my_field:</code></td>
<td>Recorre los subcampos (como <code>$a</code>, <code>$b</code>, etc.)</td>
</tr>
<tr class="even">
<td><code>hasattr(my_field, '__iter__')</code></td>
<td>Verifica si el campo tiene subcampos (evita error en campos de control como <code>001</code> o <code>008</code>)</td>
</tr>
</tbody>
</table>
<hr>
<p><strong>Notas importantes</strong></p>
<ul>
<li>Los <strong>campos de control</strong> como <code>001</code>, <code>005</code>, <code>008</code> <strong>no tienen indicadores ni subcampos</strong>, por eso generan un <code>AttributeError</code> si se intenta acceder a <code>indicator1</code> o <code>indicator2</code>.</li>
<li>Usamos <code>or "/"</code> para mostrar un valor por defecto cuando un indicador no está presente (vacío).</li>
<li>Solo se muestra un registro con <code>break</code> para <strong>evitar imprimir todo el archivo MARC</strong> durante pruebas o demostraciones.</li>
</ul>
</section>
<section id="otros-ejemplos" class="level2">
<h2 class="anchored" data-anchor-id="otros-ejemplos">Otros ejemplos</h2>
<p><strong>(a)</strong> ¿Cuál es el ID 001 del registro con el identificador OCLC 39818086?</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> reader:</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> f <span class="kw">in</span> record.get_fields(<span class="st">'035'</span>):</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"39818086"</span> <span class="kw">in</span> f.value():</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(record[<span class="st">'001'</span>].value())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>(b)</strong> ¿Cuántos registros tienen más de un campo 500?</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> reader:</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(record.get_fields(<span class="st">'500'</span>)) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(record[<span class="st">'001'</span>].value())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>(c)</strong> ¿Cuántos registros describen un ítem con inglés como idioma principal?</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> reader:</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"eng"</span> <span class="kw">in</span> record[<span class="st">'008'</span>].value():</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(record[<span class="st">'001'</span>].value())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03_introduccion_pymarc.html" class="pagination-link" aria-label="Introducción a PyMarc">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Introducción a PyMarc</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05_introduccion_pymarc3.html" class="pagination-link" aria-label="Editar con PyMARC">
        <span class="nav-page-text">Editar con PyMARC</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>